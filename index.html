<meta name='viewport' content='width=device-width, initial-scale=1'/><!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LK Fly Bird</title>

<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    user-select:none;
}
body{
    background:#70c5ce;
    overflow:hidden;
}
canvas{
    display:block;
}
.score-display{
    position:absolute;
    top:20px;
    width:100%;
    text-align:center;
    font-size:60px;
    font-weight:bold;
    color:#fff;
    text-shadow:4px 4px 0 #000;
}
.game-title{
    position:absolute;
    top:10px;
    width:100%;
    text-align:center;
    font-size:40px;
    color:#fff;
}
</style>
</head>

<body>

<canvas id="gameCanvas"></canvas>
<div class="game-title">LK FLY BIRD</div>
<div class="score-display">0</div>

<img id="birdImage" src="https://iili.io/fXCiFcJ.md.png" hidden>
<img id="pipeImage" src="https://iili.io/fXCQ3Fe.md.jpg" hidden>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const birdImg = document.getElementById("birdImage");
const pipeImg = document.getElementById("pipeImage");

let score = 0;
let gameSpeed = 1;

const bird = {
    x: canvas.width * 0.2,
    y: canvas.height / 2,
    w: 50,
    h: 50,
    gravity: 0.05,
    lift: -2.8,
    velocity: 0
};

/* =========================
   PIPE SETTINGS (ONLY CHANGE)
   ========================= */
let pipes = [];
const pipeWidth = 80;
const pipeGap = 200;        // BIG vertical gap
const pipeFrequency = 220;  // BIG horizontal spacing
let frame = 0;
/* ========================= */

// ====================
// SOUND FUNCTIONS ONLY
// ====================
let audioContext;
let soundEnabled = true;

// Initialize audio
function initAudio() {
    try {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
    } catch(e) {
        console.log("Audio not supported");
        soundEnabled = false;
    }
}

// Play beep sound
function playBeepSound(frequency, duration, volume = 0.1) {
    if (!soundEnabled || !audioContext) return;
    
    try {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.frequency.value = frequency;
        oscillator.type = 'sine';
        
        gainNode.gain.setValueAtTime(volume, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);
        
        oscillator.start();
        oscillator.stop(audioContext.currentTime + duration);
    } catch(e) {
        // Ignore audio errors
    }
}

// Flap sound
function playFlapSound() {
    playBeepSound(600, 0.1, 0.08);
}

// Score sound
function playScoreSound() {
    playBeepSound(800, 0.15, 0.1);
    setTimeout(() => playBeepSound(1000, 0.1, 0.08), 50);
}

// Collision sound ("Oh my god wow")
function playCollisionSound() {
    if (!soundEnabled || !audioContext) return;
    
    try {
        const frequencies = [200, 150, 180];
        const durations = [0.2, 0.3, 0.25];
        
        for (let i = 0; i < frequencies.length; i++) {
            setTimeout(() => {
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = frequencies[i];
                oscillator.type = 'sawtooth';
                
                gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + durations[i]);
                
                oscillator.start();
                oscillator.stop(audioContext.currentTime + durations[i]);
            }, i * 100);
        }
    } catch(e) {
        // Ignore audio errors
    }
}
// ====================

function drawBird(){
    ctx.drawImage(
        birdImg,
        bird.x - bird.w/2,
        bird.y - bird.h/2,
        bird.w,
        bird.h
    );
}

function drawPipes(){
    pipes.forEach(p=>{
        // Top pipe
        ctx.save();
        ctx.translate(p.x + pipeWidth/2, p.top/2);
        ctx.scale(1,-1);
        ctx.drawImage(pipeImg, -pipeWidth/2, -p.top/2, pipeWidth, p.top);
        ctx.restore();

        // Bottom pipe
        ctx.drawImage(
            pipeImg,
            p.x,
            p.bottom,
            pipeWidth,
            canvas.height - p.bottom
        );
    });
}

function updatePipes(){
    if(frame % pipeFrequency === 0){

        /* ðŸ”½ PIPE HEIGHT REDUCED HERE ðŸ”½ */
        let minTop = 80;
        let maxTop = canvas.height * 0.45; // shorter pipes
        let top = Math.random() * (maxTop - minTop) + minTop;

        pipes.push({
            x: canvas.width,
            top: top,
            bottom: top + pipeGap,
            passed:false
        });
    }

    pipes.forEach(p=>{
        p.x -= gameSpeed;

        if(!p.passed && p.x + pipeWidth < bird.x){
            p.passed = true;
            score++;
            document.querySelector(".score-display").innerText = score;
            // Play score sound
            playScoreSound();
        }
    });

    pipes = pipes.filter(p => p.x > -pipeWidth);
}

function updateBird(){
    bird.velocity += bird.gravity;
    bird.y += bird.velocity;
}

function collision(){
    if(bird.y + bird.h/2 > canvas.height || bird.y - bird.h/2 < 0){
        playCollisionSound();
        return true;
    }

    for(let p of pipes){
        if(
            bird.x + bird.w/2 > p.x &&
            bird.x - bird.w/2 < p.x + pipeWidth
        ){
            if(
                bird.y - bird.h/2 < p.top ||
                bird.y + bird.h/2 > p.bottom
            ){
                playCollisionSound();
                return true;
            }
        }
    }
    return false;
}

function flap(){
    bird.velocity = bird.lift;
    // Play flap sound
    playFlapSound();
}

function loop(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    updatePipes();
    updateBird();

    drawPipes();
    drawBird();

    if(collision()){
        // Small delay to hear collision sound before reloading
        setTimeout(() => {
            location.reload();
        }, 500);
        return;
    }

    frame++;
    requestAnimationFrame(loop);
}

canvas.addEventListener("click", flap);
document.addEventListener("keydown", e=>{
    if(e.code==="Space" || e.code==="ArrowUp") flap();
});

// Audio context needs user interaction to start
document.addEventListener('click', function initAudioOnClick() {
    if (audioContext && audioContext.state === 'suspended') {
        audioContext.resume();
    }
    // Initialize audio after first click
    initAudio();
    document.removeEventListener('click', initAudioOnClick);
});

// Start the game
loop();
</script>

</body>
</html>